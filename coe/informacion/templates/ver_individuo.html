{% extends 'base_informacion.html' %}

{% load static %}
{% load seguridad_tags%}

{% block content %}
    <section class="resumen">
        <section class="informacion_basica">
            <div class="container">
                <div class="row">
                    <br>
                    <h2>Individuo: {{individuo.apellidos}}, {{individuo.nombres}}</h2>
                    <div class="col-md-8">
                        <p>Documento: {{individuo.get_tipo_doc_display}} {{individuo.num_doc}}</p>
                        <p>Fecha de Nacimiento: {{individuo.fecha_nacimiento}}</p>
                        <p>Telefono: {{individuo.telefono}}</p>
                        <p>Email: {{individuo.email}}</p>
                        <p>Nacionalidad: {{individuo.nacionalidad}}</p>
                        <p>Origen: {{individuo.origen}}</p>
                        <p>Destino:{{individuo.destino}}</p>
                        {% if individuo.domicilios.all %}
                            {% with individuo.domicilio_actual as domicilio %}
                                <p>
                                    Residencia Actual: {{domicilio.calle}} {{domicilio.numero}}, {{domicilio.localidad}} ({{domicilio.aclaracion}})
                                    <a href="javascript:PopUp(2);" ><img class="icons" src="{% static '/img/icons/history.png' %}"></a>
                                </p>
                            {% endwith %}
                            <div class="popup-overlay"></div>
                            <div class="popup">
                                <div class="popuptext" id="myPopup-2">
                                    <a href="javascript:PopUp(2);" >
                                        <img class="close_icon" src="{% static 'img/icons/close.png' %}">
                                    </a>
                                    <p class="history_tittle">HISTORIAL:</p>
                                    <hr class="minibar">
                                    <ul>
                                        {% for dom in individuo.domicilios.all reversed %}
                                            <li>{{dom.calle}} {{dom.numero}}, {{dom.localidad}} ({{dom.aclaracion}}) | Fecha: {{dom.fecha|date}}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        {% else %}
                            <h4 class="alerta">NO REGISTRA RESIDENCIA ACTUAL EN LA PROVINCIA: <a href="{% url 'informacion:cargar_domicilio' individuo_id=individuo.id %}">CARGAR</a></h4>
                        {% endif %}
                        <h3>Estado: <b>{{individuo.situacion_actual}}</b> 
                            <a class="nolink" href="{% url 'informacion:cargar_situacion' individuo_id=individuo.id %}">
                                <img class="icons" src="{% static '/img/icons/change.png' %}">
                            </a>
                            <a href="javascript:PopUp(1);" ><img class="icons" src="{% static '/img/icons/history.png' %}"></a>
                        </h3>

                        <div class="popup-overlay"></div>
                        <div class="popup">
                            <div class="popuptext" id="myPopup-1">
                                <a href="javascript:PopUp(1);" >
                                    <img class="close_icon" src="{% static 'img/icons/close.png' %}">
                                </a>
                                <p class="history_tittle">HISTORIAL:</p>
                                <hr class="minibar">
                                <ul>
                                    {% for sit in individuo.situaciones.all reversed %}
                                        <li>{{sit}} ({{sit.fecha}})</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        
                        <hr>
                        {{individuo.particularidades|safe}}
                        <!--Tabla de Sintomas Registrados-->
                        {% for sintoma in individuo.sintomas.all %}
                            {% if forloop.first %}
                                <hr>
                                <h3>Sintomas:</h3>
                                <table class="listado">
                                    <tr>
                                        <th>Sintoma</th>
                                        <th>Importancia</th>
                                        <th>Aclaracion</th>
                                        <th>Fecha</th>
                                    </tr>
                            {% endif %}
                            <tr>
                                <td>{{sintoma.tipo.nombre}}</td>
                                <td>{{sintoma.tipo.get_importancia_display}}</td>
                                <td>{{sintoma.aclaracion}}</td>
                                <td>{{sintoma.fecha}}</td>
                            </tr>
                            {% if forloop.last %}
                                </table>
                            {% endif %}
                        {% endfor %}
                        <!--Tabla de Sintomas Registrados-->
                        {% for atributo in individuo.atributos.all %}
                            {% if forloop.first %}
                                <hr>
                                <h3>Atributos Registrados:</h3>
                                <table class="listado">
                                    <tr>
                                        <th>Atributo</th>
                                        <th>Importancia</th>
                                        <th>Aclaracion</th>
                                        <th>Fecha</th>
                                    </tr>
                            {% endif %}
                            <tr>
                                <td>{{atributo.tipo.nombre}}</td>
                                <td>{{atributo.tipo.get_importancia_display}}</td>
                                <td>{{atributo.aclaracion}}</td>
                                <td>{{atributo.fecha}}</td>
                            </tr>
                            {% if forloop.last %}
                                </table>
                            {% endif %}
                        {% endfor %}

                        <!--Tabla de Relaciones Registradas-->
                        {% for relacion in individuo.relaciones.all %}
                            {% if forloop.first %}
                                <hr>
                                <h3>Relaciones Registradas:</h3>
                                <table class="listado">
                                    <tr>
                                        <th>Tipo</th>
                                        <th>Individuo</th>
                                        <th>Aclaracion</th>
                                        <th>Estado</th>
                                        <th>Fecha</th>
                                    </tr>
                            {% endif %}
                            <tr>
                                <td>{{relacion.get_tipo_display}}</td>
                                <td>{{relacion.relacionado}}</td>
                                <td>{{relacion.aclaracion}}</td>
                                <td>{{relacion.relacionado.situacion_actual}}</td>
                                <td>{{relacion.fecha}}</td>
                            </tr>
                            {% if forloop.last %}
                                </table>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="col-md-4">
                        <ul class="menu_botones">
                            {% if individuo.origenes %}
                                {% for origen in individuo.origenes.all %}
                                    <li><a href="{% url 'informacion:ver_vehiculo' vehiculo_id=origen.vehiculo.id %}">Volver al Vehiculos {{origen.vehiculo}}</a></li>
                                {% endfor %}
                            {% endif %}
                            <li><a href="{% url 'informacion:mod_individuo' individuo_id=individuo.id %}">Modificar Datos Basicos</a></li>
                            <li><a href="{% url 'informacion:cargar_domicilio' individuo_id=individuo.id %}">Residencia Actual En La Provincia</a></li>
                            <li><a href="{% url 'informacion:cargar_relacion' individuo_id=individuo.id %}">Cargar Relacion</a></li>
                            <li><a href="{% url 'informacion:cargar_atributo' individuo_id=individuo.id %}">Cargar Atributo de Control</a></li>
                            <li><a href="{% url 'informacion:cargar_sintoma' individuo_id=individuo.id  %}">Cargar Sintomas</a></li>
                            <li><a href="{% url 'informacion:listar_individuos' %}">Volver al Listado de Individuos</a></li>
                            <li><a href="{% url 'informacion:listar_vehiculos' %}">Volver al Listado de Vehiculos</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </section>
{% endblock %}